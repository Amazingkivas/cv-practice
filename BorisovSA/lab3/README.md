# Практическая работа №3. Классификация изображений с использованием библиотеки OpenCV

## Описание задачи

В данной работе реализована классификация изображений с использованием метода "Bag of Visual Words" (BoVW) и машинного обучения. Целью работы является разработка системы, которая способна различать изображения двух классов (например, "коты" и "собаки") на основе их визуальных признаков. Для этого используются алгоритмы из библиотеки OpenCV, а также методы машинного обучения из библиотеки scikit-learn.

## Используемые алгоритмы и методы

### 1. **Извлечение признаков с использованием SIFT**
   - **SIFT (Scale-Invariant Feature Transform)** — это алгоритм, который позволяет извлекать ключевые точки и дескрипторы с изображений. Эти дескрипторы инвариантны к масштабу, повороту и частично к изменениям освещения, что делает их устойчивыми к различным преобразованиям изображений.
   - В данной работе SIFT используется для извлечения дескрипторов из изображений обучающей выборки.

### 2. **Построение визуального словаря (Visual Vocabulary)**
   - Для создания визуального словаря используется метод **K-means кластеризации**. Все дескрипторы, извлеченные из изображений, группируются в заданное количество кластеров (задается параметром `--clusters`). Центры кластеров образуют визуальный словарь.
   - Визуальный словарь представляет собой набор "визуальных слов", которые используются для описания изображений.

### 3. **Вычисление признаков изображений с использованием BoVW**
   - **Bag of Visual Words (BoVW)** — это метод, который преобразует изображение в вектор признаков, представляющий собой гистограмму визуальных слов. Для каждого изображения подсчитывается, сколько раз каждое визуальное слово встречается в изображении.
   - В данной работе для вычисления BoVW признаков используется класс `cv2.BOWImgDescriptorExtractor`.

### 4. **Классификация с использованием SVM**
   - Для классификации изображений используется метод опорных векторов (**SVM**, Support Vector Machine) с ядром RBF. SVM обучается на BoVW признаках, извлеченных из обучающей выборки, и затем используется для предсказания классов изображений из тестовой выборки.
   - Перед обучением данные стандартизируются с использованием `StandardScaler`.

### 5. **Оценка качества модели**
   - Для оценки качества модели используются метрики:
     - **Точность (Accuracy)** — доля правильных предсказаний.
     - **Отчет о классификации (Classification Report)** — включает метрики precision, recall и F1-score для каждого класса.
     - **Матрица ошибок (Confusion Matrix)** — позволяет визуализировать количество правильных и неправильных предсказаний.

### 6. **Визуализация**
   - Для анализа данных и результатов используются следующие визуализации:
     - **Распределение дескрипторов по кластерам** — гистограмма, показывающая, как дескрипторы распределены по кластерам.
     - **Ключевые точки на изображениях** — визуализация ключевых точек, извлеченных с помощью SIFT.
     - **Матрица ошибок** — визуализация матрицы ошибок для тестовой выборки.