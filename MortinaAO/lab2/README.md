# Практическая работа №2. Детектирование объектов на изображениях с использованием библиотеки OpenCV

Программа реализует систему обнаружения объектов на основе предобученной модели SSD MobileNet с использованием библиотеки OpenCV.

## Предварительная обработка изображений

Перед тем как изображение передаётся модели, оно должно быть преобразовано в формат, понятный нейронной сети. Для этого был реализован следующий алгоритм:

### Чтение изображения

Система считывает изображение из файла, что обеспечивает загрузку изображения в виде массива пикселей в формате BGR.

### Преобразование изображения в тензор

Для подготовки изображения используется функция create_input_tensor(), которая выполняет:
1. Масштабирование изображения до фиксированного размера.
2. Нормализация интенсивности пикселей, чтобы привести значения в необходимый диапазон.
3. Изменение цветового пространства с BGR на RGB.
4. Создание тензора с помощью cv.dnn.blobFromImage, готового для передачи в нейронную сеть.

## Обработка выхода сети

После того как тензор передаётся модели, она возвращает массив предсказаний. Для интерпретации результатов было реализовано:

### Получение и обработка предсказаний

Функция fetch_predictions() выполняет: 
1. Передачу данных в модель через model.setInput(blob) и получение предсказания с помощью model.forward().
2. Фильтрацию детекций: выбираются только предсказания с уверенностью выше заданного порога (confidence_threshold).
3. Разбор предсказаний: для каждого объекта извлекаются: класс объекта, уверенность детекции и координаты ограничивающего прямоугольника

### Отображение результатов

Функция draw_predictions() отвечает исключительно за визуализацию:
1. Отрисовка ограничивающих прямоугольников с использованием координат.
2. Вывод названия класса и уровня уверенности на изображении с использованием cv.putText().
3. Подсчёт объектов каждого класса и сохранение их в словаре detected.

## Обработка изображений и видео

1. Изображения (handle_image()): выполняется загрузка, обработка и вывод результата с отмеченными объектами.
2. Видео (handle_video()): кадр за кадром выполняется обработка с отображением результатов в реальном времени.

Таким образом, алгоритмы предварительной обработки изображений и обработки выхода сети обеспечивают эффективную работу системы детекции объектов:
Предварительная обработка преобразует изображение в формат, подходящий для модели, нормализуя его и улучшая точность предсказаний.
И обработка выхода сети фильтрует и визуализирует предсказания, упрощая интерпретацию результатов.