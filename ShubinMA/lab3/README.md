# Практическая работа №3. Классификация изображений с использованием библиотеки OpenCV

## Описание программы

Программа реализует классификацию изображений из датасета dogs-vs-cats с использованием алгоритма "мешок слов".

## Реализованные алгоритмы

### 1) Алгоритм "мешок слов"

Для классификации изображений используется алгоритм "мешок слов": изображение подаётся на вход детектору/дескриптору, который извлекает из него "особенности". Полученные "особенности" подаются на вход "словарю" - алгоритму кластеризации, предварительно обученному на аналогичных изображениях, который строит гистограмму для данного изображения по классам. На основе полученной гистограммы классификатор определяет принадлежность изображения к одному из классов.

### 2) Разделение изображений на обучающую и тестовую выборки

Перед использованием в программе изображения разделяются на обучающую и тестовую выборки. На первой будет происходить настройка параметров "словаря" и классификатора, на второй будет проверяться корректность их работы.

### 3) Загрузка и сохранение обученных "словаря" и классификатора

Для предотвращения излишних временных затрат есть возможность загрузить предварительно обученные "словарь" и классификатор. Также по окончании обучения новых "словаря" и классификатора будет сохранена информация о них, если пользователь хочет этого.

## Описание параметров запуска программы

При запуске через командную строку могут быть указаны следующие параметры:

- `--mode (-m)`: Режим работы (тренировка `Fit`, загрузка `Load`).
- `--data (-d)`: Путь до папкис изображениями датасета, разделёнными на папки "Коты" и "Собаки".
- `--classifier (-c)`: Классификатор, который будет использоваться (`RandomForest`, `GradientBoosting`, `SVC`).
- `--detectordescriptor (-dd)`: Детектор/дескриптор, который будет использоваться (`SIFT`, `ORB`).
- `--glossary (-g)`: Кластеризатор, который будет использоваться в качестве "словаря" (`KMeans`, `BisectingKMeans`).
- `--loadsave (-ls)`: Путь до папки, которая будет использоваться для загрузки или сохранения обученных "словаря" и классификатора.
- `--train_size (-tr)`: Размер обучающей выборки (будет составлена наполовину из изображений котов, наполовину из изображений собак).
- `--test_size (-ts)`:  Размер тестовой выборки (будет составлена наполовину из изображений котов, наполовину из изображений собак).
- `--cluster_num (-cl)`: Количество кластеров (параметр "словаря").
- `--random_seed (-rs)`: Seed для модуля рандом (используется при перемешивании изображений в выборках).

## Пример использования
1) Для просмотра доступных параметров:
   ```bash
   python lab3.py --help
2) При обучении новых "словаря" и классификатора:
   ```bash
   python lab3.py -m Fit -d ./dogs-vs-cats -c RandomForest -dd SIFT -g KMeans
3) При загрузке обученных "словаря" и классификатора:
   ```bash
   python lab3.py -m Load -d ./dogs-vs-cats -c RandomForest -dd SIFT -g KMeans -ls ./Fit
